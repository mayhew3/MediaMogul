<div class="modal-header">
  <h1 ng-bind="ctrl.series.title"></h1>
</div>

<div class="modal-body clearfix">

  <div class="topGrid">

    <div class="leftColumn">
      <img class="img-rounded"
           ng-src="{{ctrl.series.posterResolved}}"
           err-src="images/GenericSeries.gif"
           width="210px"
           ng-click="ctrl.openChangePoster()"/>
    </div>

    <div class="middleColumn" ng-show="ctrl.owned">

      <div>
      <!-- Series scores -->

      <form class="bs-component"
            id="seriesFields"
            name="seriesFields"
            ng-submit="ctrl.rateMyShow()"
            novalidate>

        <div class="scoresSection detailSection">

          <div class="scoreTitle" style="grid-column: 1; grid-row: 1">
            <span>Rating:</span>
          </div>
          <div class="ratingInputBox" style="grid-column: 2; grid-row: 1">
            <input type="number"
                   class="ratingInput form-control"
                   id="myRatingInput"
                   name="myRatingInput"
                   min="1"
                   max="100"
                   ng-model="ctrl.interfaceFields.my_rating"/>
          </div>
          <div style="grid-column: 3; grid-row: 1">
            <button class="btn btn-default ratingSaveButton"
                    type="submit"
                    ng-disabled="seriesFields.$invalid || !ctrl.ratingIsChanged()">Save</button>
          </div>



          <div class="scoreTitle" style="grid-column: 1; grid-row: 2">
            <span>Metacritic:</span>
          </div>
          <div style="grid-column-start: 2; grid-column-end: 3; grid-row: 2">
            <rating-box value="ctrl.series.metacritic"
                        max-value="100"></rating-box>
          </div>

          <div class="scoreTitle" style="grid-column: 1; grid-row: 3">
            <span>Dynamic:</span>
          </div>
          <div style="grid-column-start: 2; grid-column-end: 3; grid-row: 3">
            <rating-box value="ctrl.series.dynamic_rating"
                        max-value="100"></rating-box>
          </div>

        </div>
      </form>
      </div>

    </div>

    <div class="spanningColumn" ng-show="ctrl.adding && !ctrl.owned">
      <div>
        Watched:
        <input type="button"
               class="btn btn-lg"
               value="All"
               ng-class="ctrl.getHighlightedEpisodesButton('All')"
               ng-click="ctrl.allWatched()">
        <input type="button"
               class="btn btn-lg"
               value="Some"
               ng-class="ctrl.getHighlightedEpisodesButton('Some')"
               ng-click="ctrl.someWatched()">
        <input type="button"
               class="btn btn-lg"
               value="None"
               ng-class="ctrl.getHighlightedEpisodesButton('None')"
               ng-click="ctrl.noneWatched()">
      </div>
      <div ng-show="ctrl.isSelectedAddingEpisodes('Some')" style="margin-top: 10px">
        Select last watched episode below:
      </div>
    </div>

    <div class="rightColumn" ng-show="ctrl.owned">
      <!-- Ownership status -->

      <div class="detailRightSide">


          <div class="btn-group ownershipButtonGroup detailSection" role="group" id="ownerships" ng-show="ctrl.owned">
            <button type="button"
                    class="btn"
                    ng-class="ctrl.getPinnedClass()"
                    ng-click="ctrl.changeTier(1)">Pinned</button>
            <button type="button"
                    class="btn"
                    ng-class="ctrl.getBacklogClass()"
                    ng-click="ctrl.changeTier(2)">Backlog</button>
            <button type="button"
                    class="btn"
                    ng-class="ctrl.getRemovedClass()"
                    ng-click="ctrl.removeFromMyShows()">Removed</button>
          </div>



          <!-- Admin functions -->

          <div class="detailSection btn-group" ng-show="ctrl.LockService.isAdmin()">
            <button type="button"
                    class="btn btn-default"
                    ng-click="ctrl.openEditSeries()"
                    ng-show="ctrl.LockService.isAdmin()"
                    ng-disabled="!ctrl.LockService.isAuthenticated">Edit</button>

            <button type="button"
                    class="btn btn-warning"
                    ng-show="ctrl.LockService.isAdmin()"
                    ng-disabled="ctrl.series.tvdb_manual_queue"
                    ng-click="ctrl.queueForManualUpdate()">TVDB Update</button><br>
            <span ng-bind="'Last Update: ' + ctrl.daysSinceLastUpdate + ' days.'"></span>
          </div>

      </div>
    </div>

    <div class="bottomRow" ng-show="ctrl.shouldDisplayEpisodeList()">
      Season:
      <label ng-repeat="season in ctrl.seasonLabels"
             ng-class="ctrl.getSeasonButtonClass(season)"
             ng-model="ctrl.selectedSeason"
             style="font-size: x-large"
             uib-btn-radio="season">
        <span ng-bind="season"></span>
      </label>
    </div>
  </div>

  <table class="table table-striped table-hover" ng-show="ctrl.shouldDisplayEpisodeList()">
    <thead>
    <tr>
      <th>Episode</th>
      <th>Title</th>
      <th>Date</th>
      <th>Watched</th>
      <th ng-show="ctrl.owned">Rating</th>
      <th ng-show="ctrl.adding">Select</th>
    </tr>
    </thead>
    <tr data-ng-repeat="episode in ctrl.episodes |
                          filter:ctrl.episodeFilter |
                          orderBy:['tvdb_episode_number']"
        ng-click="ctrl.openEpisodeDetailFromRow(episode)"
        ng-class="ctrl.rowClass(episode)">
      <td ng-bind="episode.episode_number"></td>
      <td ng-bind="episode.title" class="episodeDescription"></td>
      <td ng-bind="episode.air_time|date:ctrl.getDateFormat(episode.air_time):'America/Los_Angeles'"></td>
      <td>
        <span ng-bind="ctrl.getWatchedDateOrWatched(episode)"></span>
      </td>
      <td ng-style="episode.colorStyle()"
          width="70"
          ng-show="ctrl.owned">
        <span ng-bind="ctrl.getRating(episode)"></span>
      </td>
      <td ng-show="ctrl.adding">
        <input type="button"
               class="btn btn-success btn-sm"
               value="Select"
               ng-show="episode.season !== 0 && !self.isUnaired(episode)"
               ng-click="ctrl.selectLastWatchedEpisode(episode)">
        <input type="button"
               class="btn btn-info btn-sm"
               value="Info"
               ng-click="ctrl.openEpisodeDetailFromButton(episode)">
      </td>
    </tr>
  </table>

</div>

<div class="modal-footer">
  <input type="button"
         class="btn btn-success"
         value="Add Show"
         ng-show="ctrl.adding"
         ng-click="ctrl.submitSeriesAdded()">
  <button class="btn btn-primary" ng-click="ctrl.close()">Close</button>
</div>