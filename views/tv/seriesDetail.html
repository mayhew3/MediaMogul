<div class="modal-header">
  <h1 ng-bind="ctrl.series.title"></h1>
</div>

<div class="modal-body clearfix">

  <div class="row">

    <!--    Poster -->
    <div class="col-md-3 col-sm-4 col-xs-6">
      <tv-poster show="ctrl.series"
                 poster-info="{}"
                 on-click="ctrl.openChangePoster"></tv-poster>
    </div>

<!--    Ratings Section -->
    <div class="col-md-4 col-xs-6" ng-show="ctrl.owned">

      <div>
      <!-- Series scores -->

      <form class="bs-component"
            id="seriesFields"
            name="seriesFields"
            ng-submit="ctrl.rateMyShow()"
            novalidate>

        <div class="row detailSection">

          <div class="col-md-12 col-xs-12">

            <div class="row">
              <div class="col-md-4 col-xs-12" style="padding: 0">
                <span>Rating:</span>
              </div>
              <div class="col-md-4 col-xs-6" style="padding: 0">
                <input type="number"
                       class="darkInput form-control seriesRatingInput"
                       id="myRatingInput"
                       name="myRatingInput"
                       min="1"
                       max="100"
                       ng-model="ctrl.interfaceFields.my_rating"/>
              </div>
              <div class="col-md-4 col-xs-6" style="padding: 0">
                <button class="btn btn-default ratingSaveButton"
                        type="submit"
                        ng-disabled="seriesFields.$invalid || !ctrl.ratingIsChanged()">Save</button>
              </div>
            </div>

            <div class="row">
              <div class="col-md-4 col-xs-12" style="padding: 0">
                <span>Metacritic:</span>
              </div>
              <div class="col-md-4 col-xs-12" style="padding: 0">
                <rating-box value="ctrl.series.metacritic"
                            max-value="100"></rating-box>
              </div>
            </div>

            <div class="row">
              <div class="col-md-4 col-xs-12" style="padding: 0">
                <span>Dynamic:</span>
              </div>
              <div class="col-md-4 col-xs-12" style="padding: 0">
                <rating-box value="ctrl.series.dynamic_rating"
                            max-value="100"></rating-box>
              </div>
            </div>

          </div>

        </div>
      </form>
      </div>

    </div>

<!--    Add Show: Which episodes have I watched? -->
    <div class="col-md-8 col-xs-8" ng-show="ctrl.adding && !ctrl.owned">
      <div>
        Watched:
        <input type="button"
               class="btn btn-lg"
               value="All"
               ng-class="ctrl.getHighlightedEpisodesButton('All')"
               ng-click="ctrl.allWatched()">
        <input type="button"
               class="btn btn-lg"
               value="Some"
               ng-class="ctrl.getHighlightedEpisodesButton('Some')"
               ng-click="ctrl.someWatched()">
        <input type="button"
               class="btn btn-lg"
               value="None"
               ng-class="ctrl.getHighlightedEpisodesButton('None')"
               ng-click="ctrl.noneWatched()">
      </div>
      <div ng-show="ctrl.isSelectedAddingEpisodes('Some')" style="margin-top: 10px">
        Select last watched episode below:
      </div>
    </div>

<!--    Ownership status and Admin Functions -->
    <div class="col-md-4 col-xs-12" ng-show="ctrl.owned">

      <div class="row detailRightSide">

        <!-- Ownership status -->
          <div class="btn-group detailSection col-md-12"
               role="group"
               id="ownerships"
               ng-show="ctrl.owned">
            <button type="button"
                    class="btn"
                    ng-class="ctrl.getPinnedClass()"
                    ng-click="ctrl.changeTier(1)">Pinned</button>
            <button type="button"
                    class="btn"
                    ng-class="ctrl.getBacklogClass()"
                    ng-click="ctrl.changeTier(2)">Backlog</button>
            <button type="button"
                    class="btn"
                    ng-class="ctrl.getRemovedClass()"
                    ng-click="ctrl.removeFromMyShows()">Removed</button>
          </div>


          <!-- Admin functions -->

          <div class="detailSection btn-group col-md-12" ng-show="ctrl.LockService.isAdmin()">
            <button type="button"
                    class="btn btn-default"
                    ng-click="ctrl.openEditSeries()"
                    ng-show="ctrl.LockService.isAdmin()"
                    ng-disabled="!ctrl.LockService.isAuthenticated">Edit</button>

            <button type="button"
                    class="btn btn-warning"
                    ng-show="ctrl.LockService.isAdmin()"
                    ng-disabled="ctrl.series.tvdb_manual_queue"
                    ng-click="ctrl.queueForManualUpdate()">TVDB Update</button><br>
            <span ng-bind="'Last Update: ' + ctrl.daysSinceLastUpdate + ' days.'"></span>
          </div>

      </div>
    </div>

    <!-- Add the extra clearfix for only the required viewport -->
    <div class="clearfix visible-md-block visible-lg-block"></div>

    <!-- Watch Multiple -->
    <div class="col-md-3 col-sm-4 col-xs-6">
      <button type="button"
              class="btn btn-lg btn-success"
              ng-show="!ctrl.watchMultiple && !ctrl.adding && ctrl.shouldDisplayEpisodeList()"
              ng-click="ctrl.clickWatchMultiple()">
        Watch Multiple
      </button>
      <button type="button"
              class="btn btn-lg btn-success"
              ng-show="ctrl.watchMultiple && !ctrl.adding"
              ng-click="ctrl.submitMulti()">
        Submit
      </button>
      <button type="button"
              class="btn btn-lg btn-primary"
              ng-show="ctrl.watchMultiple && !ctrl.adding"
              ng-click="ctrl.cancelMulti()">
        Cancel
      </button>
    </div>

    <!-- Season Dropdown -->
    <div class="col-md-3 col-sm-4 col-xs-6" ng-show="ctrl.shouldDisplaySeasonList() && ctrl.shouldDisplayEpisodeList()">

      <drop-down initial-value="ctrl.selectedSeason"
                 possible-values="ctrl.possibleSeasons"
                 format-function="ctrl.getSeasonLabel"
                 badge-value-function="ctrl.getUnwatchedForSeason"
                 on-change-callback="ctrl.selectSeason"></drop-down>

    </div>


  </div>

  <!-- Episode List -->
  <div class="row">
    <div class="col-md-12 col-xs-12">
      <table class="table table-striped table-hover" ng-show="ctrl.shouldDisplayEpisodeList()">
        <thead>
        <tr>
          <th>Ep</th>
          <th>Title</th>
          <th class="hidden-xs">Date</th>
          <th>Watched</th>
          <th ng-show="ctrl.owned && !ctrl.watchMultiple">Rating</th>
          <th ng-show="ctrl.adding || ctrl.watchMultiple">Select</th>
        </tr>
        </thead>
        <tr data-ng-repeat="episode in ctrl.episodes |
                          filter:ctrl.episodeFilter |
                          orderBy:['absolute_number'] |
                          limitTo: ctrl.pageSize : (ctrl.currentPage - 1) * ctrl.pageSize"
            ng-click="ctrl.openEpisodeDetailFromRow(episode)"
            ng-class="ctrl.rowClass(episode)">
          <td ng-bind="episode.episode_number"></td>
          <td ng-bind="episode.title" class="episodeDescription"></td>
          <td class="hidden-xs"
              ng-bind="episode.air_time|date:ctrl.getDateFormat(episode.air_time):'America/Los_Angeles'"></td>
          <td ng-hide="ctrl.watchMultiple">
            <span ng-bind="ctrl.getWatchedDateOrWatched(episode)"></span>
          </td>
          <td ng-style="episode.colorStyle()"
              width="70"
              ng-show="ctrl.owned && !ctrl.watchMultiple">
            <span ng-bind="ctrl.getRating(episode)"></span>
          </td>
          <td ng-show="ctrl.watchMultiple">
            <input type="button"
                   class="btn"
                   ng-value="ctrl.watchButtonText(episode)"
                   ng-class="ctrl.watchButtonClass(episode)"
                   ng-show="episode.season !== 0 && !ctrl.isUnaired(episode)"
                   ng-click="ctrl.toggleMulti(episode)">
          </td>
          <td ng-show="ctrl.watchMultiple">
            <input type="button"
                   class="btn"
                   value="This & Previous"
                   ng-class="ctrl.watchButtonClass(episode)"
                   ng-show="episode.season !== 0 && !ctrl.isUnaired(episode)"
                   ng-click="ctrl.toggleMultiAndPrevious(episode)">
          </td>
          <td ng-show="ctrl.adding">
            <input type="button"
                   class="btn btn-success btn-sm"
                   value="Select"
                   ng-show="episode.season !== 0 && !ctrl.isUnaired(episode)"
                   ng-click="ctrl.selectLastWatchedEpisode(episode)">
            <input type="button"
                   class="btn btn-info btn-sm"
                   value="Info"
                   ng-click="ctrl.openEpisodeDetailFromButton(episode)">
          </td>
        </tr>
      </table>
    </div>
  </div>

  <!-- Episode Paging -->
  <div class="row" ng-show="ctrl.shouldDisplayEpisodeList()">
    <div class="col-md-12 col-xs-12" ng-show="ctrl.totalItems() > ctrl.pageSize">
      <ul uib-pagination
          total-items="ctrl.totalItems()"
          ng-model="ctrl.currentPage"
          items-per-page="ctrl.pageSize"></ul>
    </div>
  </div>


</div>

<div class="modal-footer">
  <input type="button"
         class="btn btn-success"
         value="Add Show"
         ng-show="ctrl.adding"
         ng-click="ctrl.submitSeriesAdded()">
  <button class="btn btn-primary btn-lg" ng-hide="ctrl.watchMultiple" ng-click="ctrl.close()">Close</button>
  <button class="btn btn-success btn-lg" ng-show="ctrl.watchMultiple" ng-click="ctrl.submitAndClose()">Submit and Close</button>
</div>
